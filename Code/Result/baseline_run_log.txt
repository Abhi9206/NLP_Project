Data Directory: /home/ubuntu/Project/Data
Using device: cuda
Loading TRAIN split from: /home/ubuntu/Project/Data/train.csv
Loading VALIDATION split from: /home/ubuntu/Project/Data/val.csv
Full Train rows: 79192, Full Val rows: 9899
After column filtering - Train rows: 79192, Val rows: 9899
Formatting text for TRAIN split...
Formatting text for VALIDATION split...
HF Datasets - Train size: 79192, Val size: 9899
Loading tokenizer & model: gpt2
Tokenizing datasets...

Starting training...
Epoch 1/5 - Train loss/token: 1.1939, Val loss/token: 1.0514
New best model at epoch 1, saving checkpoint to ./story-gpt2-best ...
Epoch 2/5 - Train loss/token: 1.0399, Val loss/token: 0.9977
New best model at epoch 2, saving checkpoint to ./story-gpt2-best ...
Epoch 3/5 - Train loss/token: 0.9749, Val loss/token: 0.9704
New best model at epoch 3, saving checkpoint to ./story-gpt2-best ...
Epoch 4/5 - Train loss/token: 0.9286, Val loss/token: 0.9569
New best model at epoch 4, saving checkpoint to ./story-gpt2-best ...
Epoch 5/5 - Train loss/token: 0.8913, Val loss/token: 0.9472
New best model at epoch 5, saving checkpoint to ./story-gpt2-best ...
Saving final (last-epoch) model...
Final model saved to ./story-gpt2-final
Reloading best model from ./story-gpt2-best for generation & evaluation...
Generating stories for VALIDATION set (ALL rows)...
Generating story 0/9899...
Generating story 50/9899...
Generating story 100/9899...
Generating story 150/9899...
Generating story 200/9899...
Generating story 250/9899...
Generating story 300/9899...
Generating story 350/9899...
Generating story 400/9899...
Generating story 450/9899...
Generating story 500/9899...
Generating story 550/9899...
Generating story 600/9899...
Generating story 650/9899...
Generating story 700/9899...
Generating story 750/9899...
Generating story 800/9899...
Generating story 850/9899...
Generating story 900/9899...
Generating story 950/9899...
Generating story 1000/9899...
Generating story 1050/9899...
Generating story 1100/9899...
Generating story 1150/9899...
Generating story 1200/9899...
Generating story 1250/9899...
Generating story 1300/9899...
Generating story 1350/9899...
Generating story 1400/9899...
Generating story 1450/9899...
Generating story 1500/9899...
Generating story 1550/9899...
Generating story 1600/9899...
Generating story 1650/9899...
Generating story 1700/9899...
Generating story 1750/9899...
Generating story 1800/9899...
Generating story 1850/9899...
Generating story 1900/9899...
Generating story 1950/9899...
Generating story 2000/9899...
Generating story 2050/9899...
Generating story 2100/9899...
Generating story 2150/9899...
Generating story 2200/9899...
Generating story 2250/9899...
Generating story 2300/9899...
Generating story 2350/9899...
Generating story 2400/9899...
Generating story 2450/9899...
Generating story 2500/9899...
Generating story 2550/9899...
Generating story 2600/9899...
Generating story 2650/9899...
Generating story 2700/9899...
Generating story 2750/9899...
Generating story 2800/9899...
Generating story 2850/9899...
Generating story 2900/9899...
Generating story 2950/9899...
Generating story 3000/9899...
Generating story 3050/9899...
Generating story 3100/9899...
Generating story 3150/9899...
Generating story 3200/9899...
Generating story 3250/9899...
Generating story 3300/9899...
Generating story 3350/9899...
Generating story 3400/9899...
Generating story 3450/9899...
Generating story 3500/9899...
Generating story 3550/9899...
Generating story 3600/9899...
Generating story 3650/9899...
Generating story 3700/9899...
Generating story 3750/9899...
Generating story 3800/9899...
Generating story 3850/9899...
Generating story 3900/9899...
Generating story 3950/9899...
Generating story 4000/9899...
Generating story 4050/9899...
Generating story 4100/9899...
Generating story 4150/9899...
Generating story 4200/9899...
Generating story 4250/9899...
Generating story 4300/9899...
Generating story 4350/9899...
Generating story 4400/9899...
Generating story 4450/9899...
Generating story 4500/9899...
Generating story 4550/9899...
Generating story 4600/9899...
Generating story 4650/9899...
Generating story 4700/9899...
Generating story 4750/9899...
Generating story 4800/9899...
Generating story 4850/9899...
Generating story 4900/9899...
Generating story 4950/9899...
Generating story 5000/9899...
Generating story 5050/9899...
Generating story 5100/9899...
Generating story 5150/9899...
Generating story 5200/9899...
Generating story 5250/9899...
Generating story 5300/9899...
Generating story 5350/9899...
Generating story 5400/9899...
Generating story 5450/9899...
Generating story 5500/9899...
Generating story 5550/9899...
Generating story 5600/9899...
Generating story 5650/9899...
Generating story 5700/9899...
Generating story 5750/9899...
Generating story 5800/9899...
Generating story 5850/9899...
Generating story 5900/9899...
Generating story 5950/9899...
Generating story 6000/9899...
Generating story 6050/9899...
Generating story 6100/9899...
Generating story 6150/9899...
Generating story 6200/9899...
Generating story 6250/9899...
Generating story 6300/9899...
Generating story 6350/9899...
Generating story 6400/9899...
Generating story 6450/9899...
Generating story 6500/9899...
Generating story 6550/9899...
Generating story 6600/9899...
Generating story 6650/9899...
Generating story 6700/9899...
Generating story 6750/9899...
Generating story 6800/9899...
Generating story 6850/9899...
Generating story 6900/9899...
Generating story 6950/9899...
Generating story 7000/9899...
Generating story 7050/9899...
Generating story 7100/9899...
Generating story 7150/9899...
Generating story 7200/9899...
Generating story 7250/9899...
Generating story 7300/9899...
Generating story 7350/9899...
Generating story 7400/9899...
Generating story 7450/9899...
Generating story 7500/9899...
Generating story 7550/9899...
Generating story 7600/9899...
Generating story 7650/9899...
Generating story 7700/9899...
Generating story 7750/9899...
Generating story 7800/9899...
Generating story 7850/9899...
Generating story 7900/9899...
Generating story 7950/9899...
Generating story 8000/9899...
Generating story 8050/9899...
Generating story 8100/9899...
Generating story 8150/9899...
Generating story 8200/9899...
Generating story 8250/9899...
Generating story 8300/9899...
Generating story 8350/9899...
Generating story 8400/9899...
Generating story 8450/9899...
Generating story 8500/9899...
Generating story 8550/9899...
Generating story 8600/9899...
Generating story 8650/9899...
Generating story 8700/9899...
Generating story 8750/9899...
Generating story 8800/9899...
Generating story 8850/9899...
Generating story 8900/9899...
Generating story 8950/9899...
Generating story 9000/9899...
Generating story 9050/9899...
Generating story 9100/9899...
Generating story 9150/9899...
Generating story 9200/9899...
Generating story 9250/9899...
Generating story 9300/9899...
Generating story 9350/9899...
Generating story 9400/9899...
Generating story 9450/9899...
Generating story 9500/9899...
Generating story 9550/9899...
Generating story 9600/9899...
Generating story 9650/9899...
Generating story 9700/9899...
Generating story 9750/9899...
Generating story 9800/9899...
Generating story 9850/9899...
Running evaluation metrics on FULL VALIDATION set...

Validation Evaluation Summary (FULL validation set):
corpus_bleu: 0.0829
avg_perplexity: 13.5553
bert_precision: 0.5843
bert_recall: 0.6464
bert_f1: 0.6132
rouge1: 0.4313
rouge2: 0.1386
rougeL: 0.2395
keyword_strict_accuracy: 0.5300
keyword_avg_percentage: 80.9038

Saved per-example validation metrics to evaluation_results_val_full.csv
